#include "image.h"

struct letter{
  char lines[5];
};

const char START = ' ';
const char END = '~';

struct letter alpha[] = {
/* (space)*/ {{0,0,0,0,0}},
/*!*/ {{ 0b00100, 0b00100, 0b00100, 0b00000, 0b00100 }},
/*"*/ {{ 0b01010, 0b01010, 0, 0, 0}},
/*#*/ {{ 0b01010, 0b11111, 0b01010, 0b11111, 0b01010 }},
/*$*/ {{ 0b01110, 0b10100, 0b01110, 0b00101, 0b01110 }},
/*%*/ {{ 0b10001, 0b10010, 0b00100, 0b01001, 0b10001 }},
/*&*/ {{ 0b01000, 0b10100, 0b01101, 0b10010, 0b01101 }},
/*'*/ {{ 0b00100, 0b00100, 0, 0, 0}},
/*(*/ {{ 0b00010, 0b00100, 0b00100, 0b00100, 0b00010 }},
/*)*/ {{ 0b01000, 0b00100, 0b00100, 0b00100, 0b01000 }},
/***/ {{ 0b10101, 0b01110, 0b10101, 0, 0 }},
/*+*/ {{ 0b00100, 0b00100, 0b11111, 0b00100, 0b00100 }},
/*,*/ {{ 0, 0, 0, 0b00100, 0b01000 }},
/*-*/ {{ 0, 0, 0b11111, 0, 0 }},
/*.*/ {{ 0, 0, 0, 0, 0b00100 }},
/* / */{{0b00001, 0b00010, 0b00100, 0b01000, 0b10000 }},
/*0*/ {{ 0b01110, 0b10001, 0b10001, 0b10001, 0b01110 }},
/*1*/ {{ 0b00100, 0b01100, 0b00100, 0b00100, 0b01110 }},
/*2*/ {{ 0b00110, 0b01001, 0b00010, 0b00100, 0b01111 }},
/*3*/ {{ 0b01110, 0b00001, 0b00110, 0b00001, 0b01110 }},
/*4*/ {{ 0b10010, 0b10010, 0b11111, 0b00010, 0b00010 }},
/*5*/ {{ 0b11110, 0b10000, 0b11100, 0b00010, 0b11100 }},
/*6*/ {{ 0b01100, 0b10000, 0b11100, 0b10010, 0b01100 }},
/*7*/ {{0b11111, 0b00010, 0b00100, 0b01000, 0b10000 }},
/*8*/ {{ 0b01100, 0b10010, 0b01100, 0b10010, 0b01100 }},
/*9*/ {{ 0b01100, 0b10010, 0b01110, 0b00010, 0b00010 }},
/*:*/ {{ 0b00000, 0b00100, 0b00000, 0b00100, 0b00000, }},
/*;*/ {{ 0b00000, 0b00100, 0b00000, 0b00100, 0b01000, }},
/*<*/ {{ 0b00010, 0b00100, 0b01000, 0b00100, 0b00010, }},
/*=*/ {{ 0b00000, 0b01110, 0b00000, 0b01110, 0b00000 }},
/*>*/ {{ 0b01000, 0b00100, 0b00010, 0b00100, 0b01000, }},
/*?*/ {{ 0b01100, 0b10010, 0b00100, 0b00000, 0b00100 }},
/*@*/ {{ 0b01110, 0b10001, 0b10111, 0b10101, 0b10111 }},
/*A*/ {{ 0b01110, 0b10001, 0b11111, 0b10001, 0b10001 }},
/*B*/ {{ 0b11110, 0b10001, 0b11110, 0b10001, 0b11110 }},
/*C*/ {{ 0b01110, 0b10001, 0b10000, 0b10001, 0b01110 }},
/*D*/ {{ 0b11110, 0b10001, 0b10001, 0b10001, 0b11110 }},
 {{ 0b11111, 0b10000, 0b11111, 0b10000, 0b11111 }},
 {{ 0b11111, 0b10000, 0b11111, 0b10000, 0b10000 }},
 {{ 0b01111, 0b10000, 0b10111, 0b10001, 0b01110 }},
 {{ 0b10001, 0b10001, 0b11111, 0b10001, 0b10001 }},
 {{ 0b01110, 0b00100, 0b00100, 0b00100, 0b01110 }},
 {{ 0b01110, 0b00100, 0b00100, 0b10100, 0b01000 }},
 {{ 0b10010, 0b10100, 0b11000, 0b10100, 0b10010 }},
 {{ 0b10000, 0b10000, 0b10000, 0b10000, 0b11111 }},
/*M*/ {{ 0b10001, 0b11011, 0b10101, 0b10001, 0b10001 }},
 {{ 0b10001, 0b11001, 0b10101, 0b10011, 0b10001 }},
 {{ 0b01110, 0b10001, 0b10001, 0b10001, 0b01110 }},
/*P*/ {{ 0b11110, 0b10001, 0b11110, 0b10000, 0b10000 }},
 {{ 0b01110, 0b10001, 0b10001, 0b10011, 0b01111 }},
 {{ 0b11110, 0b10001, 0b11110, 0b10010, 0b10001 }},
 {{ 0b01111, 0b10000, 0b01110, 0b00001, 0b11110 }},
 {{ 0b11111, 0b00100, 0b00100, 0b00100, 0b00100 }},
 {{ 0b10001, 0b10001, 0b10001, 0b10001, 0b01110 }},
 {{ 0b10001, 0b10001, 0b10001, 0b01010, 0b00100 }},
 {{ 0b10001, 0b10001, 0b10101, 0b10101, 0b01010 }},
 {{ 0b10001, 0b01010, 0b00100, 0b01010, 0b10001 }},
 {{ 0b10001, 0b01010, 0b00100, 0b00100, 0b00100 }},
/*Z*/ {{ 0b11111, 0b00010, 0b00100, 0b01000, 0b11111 }},
/*[*/ {{ 0b00110, 0b00100, 0b00100, 0b00100, 0b00110 }},
/*\*/ {{ 0b10000, 0b01000, 0b00100, 0b00010, 0b00001 }},
/*]*/ {{ 0b01100, 0b00100, 0b00100, 0b00100, 0b01100 }},
/*^*/ {{ 0b00100, 0b01010, 0b10001, 0, 0}},
/*_*/ {{ 0, 0, 0, 0, 0b11111 }},
/*`*/ {{ 0, 0b01000, 0b00100, 0, 0}},
/***** These should be lower case, but aren't: */
/*a*/ {{ 0b01110, 0b10001, 0b11111, 0b10001, 0b10001 }},
/*b*/ {{ 0b11110, 0b10001, 0b11110, 0b10001, 0b11110 }},
/*c*/ {{ 0b01110, 0b10001, 0b10000, 0b10001, 0b01110 }},
/*d*/ {{ 0b11110, 0b10001, 0b10001, 0b10001, 0b11110 }},
/*e*/ {{ 0b11111, 0b10000, 0b11111, 0b10000, 0b11111 }},
/*f*/ {{ 0b11111, 0b10000, 0b11111, 0b10000, 0b10000 }},
/*g*/ {{ 0b01111, 0b10000, 0b10111, 0b10001, 0b01110 }},
/*h*/ {{ 0b10001, 0b10001, 0b11111, 0b10001, 0b10001 }},
/*i*/ {{ 0b00100, 0b00000, 0b01100, 0b00100, 0b01110 }},
/*j*/ {{ 0b00100, 0b00000, 0b00100, 0b10100, 0b01000 }},
/*k*/ {{ 0b10010, 0b10100, 0b11000, 0b10100, 0b10010 }},
/*l*/ {{ 0b10000, 0b10000, 0b10000, 0b10000, 0b11111 }},
/*m*/ {{ 0b10001, 0b11011, 0b10101, 0b10001, 0b10001 }},
/*n*/ {{ 0b10001, 0b11001, 0b10101, 0b10011, 0b10001 }},
/*o*/ {{ 0b01110, 0b10001, 0b10001, 0b10001, 0b01110 }},
/*p*/ {{ 0b11110, 0b10001, 0b11110, 0b10000, 0b10000 }},
/*q*/ {{ 0b01110, 0b10001, 0b10001, 0b10011, 0b01111 }},
/*r*/ {{ 0, 0b10110, 0b11000, 0b10000, 0b10000 }},
/*s*/ {{ 0b01111, 0b10000, 0b01110, 0b00001, 0b11110 }},
/*t*/ {{ 0b00100, 0b01110, 0b00100, 0b00100, 0b00110 }},
/*u*/ {{ 0, 0b10001, 0b10001, 0b10001, 0b01110 }},
/*v*/ {{ 0, 0b10001, 0b10001, 0b01010, 0b00100 }},
/*w*/ {{ 0, 0b10001, 0b10001, 0b10101, 0b01010 }},
/*x*/ {{ 0, 0, 0b01010, 0b00100, 0b01010}},
/*y*/ {{ 0b10001, 0b01010, 0b00100, 0b00100, 0b00100 }},
/*z*/ {{ 0, 0b01111, 0b00010, 0b00100, 0b01111 }},
/* End lower case */
/*{*/ {{ 0b00111, 0b00100, 0b01100, 0b00100, 0b00111}},
/*|*/ {{ 4,4,4,4,4 }},
/*}*/ {{ 0b11100, 0b00100, 0b00110, 0b00100, 0b11100}},
/*~*/ {{ 0, 0b01000, 0b10101, 0b00010, 0}},
};

/* Prints a line of text onto an image */
void render(char *line, int colour, int top, int left, struct image *image) {
  for(int i = 0; i < 5;i++) {
    int c; size_t idx = 0;
    while( (c = line[idx++]) ) {
      if(c < START || c > END) {c = START;}
      for(int j = 4; j >= 0; j--) {
        if(1<<j & alpha[c-START].lines[i]) {
          image->data[(top+i)*image->width + 6*(idx-1) +4-j +left] = colour;
        }
      }
    }
  }
}
